<!DOCTYPE html>
<html>

<head>

  <title>Place searches</title>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">

</head>

<body>
  <div id="map"></div>
  <div class="resultsContainer"></div>

  <style>
    /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */

    #map {
      height: 100%;
    }

    /* Optional: Makes the sample page fill the window. */

    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>

  <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCls9uUYJ4bnkQM3T704Qsc9-bAyjIqL88&libraries=places&callback=initMap" async defer></script>
  <script type="text/javascript" src="javascript/app.js"></script>

  <script type="text/javascript">

  var map;
  var infowindow;
  var resultsArray = [];

  function initMap() {
    var pyrmont = {
      lat: 30.2672,
      lng: -97.7431
    }; //What we replace with what we type into the search bar

    map = new google.maps.Map(document.getElementById('map'), {
      center: pyrmont,
      zoom: 15
    });

    infowindow = new google.maps.InfoWindow();
    var service = new google.maps.places.PlacesService(map);
    service.nearbySearch({
      location: pyrmont,
      radius: 1000,
      type: ['bar']
    }, callback);
  }

  function callback(results, status) {
    if (status === google.maps.places.PlacesServiceStatus.OK) {
      for (var i = 0; i < results.length; i++) {
        createMarker(results[i]);
        resultsArray.push(results[i]);
      }

    }
    createResultItems();
  }

  function createMarker(place) {
    var placeLoc = place.geometry.location;
    var marker = new google.maps.Marker({
      map: map,
      position: place.geometry.location
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent(place.name);
      infowindow.open(map, this);
    });
  }

  function createResultItems() {

    for (var i = 0; i < resultsArray.length; i++) {

      var name = $("<div>").append(resultsArray[i].name).addClass("resultName");
      var rating = $("<div>").append(resultsArray[i].rating).addClass("resultRating");
      var vicinity = $("<div>").append(resultsArray[i].vicinity).addClass("resultPhoto");

      var newDiv = $("<div>");



      newDiv.append(name);
      newDiv.append(rating);
      newDiv.append(vicinity);

      $(".resultsContainer").append(newDiv);

    }
  }
  </script>


</body>

</html>
